(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const y=(e,t)=>{e=Math.abs(e),t=Math.abs(t);const o=Math.ceil(Math.min(e,t)),s=Math.floor(Math.max(e,t)),n=Math.random()*(s-o+1)+o;return Math.floor(n)},b=e=>e[y(0,e.length-1)],V=()=>{let e=0;return()=>(e+=1,e)},U=(e,t,o)=>{const s=document.createDocumentFragment();for(const n of t)s.append(o(n));e.append(s)},H=({key:e})=>e==="Escape",N=e=>document.getElementById(e).content.firstElementChild,B=5,K=N("comment"),C=document.querySelector(".social__comments"),G=document.querySelector(".social__comment-count"),T=document.querySelector(".social__comments-loader");let S=[];const z=e=>{const t=K.cloneNode(!0);return t.querySelector(".social__picture").src=e.avatar,t.querySelector(".social__text").textContent=e.message,t},X=()=>{const e=S.length,t=C.children.length;let o=t+B;const s=o>=e;o=s?e:o;const n=S.slice(t,o);U(C,n,z),G.textContent=`${o} из ${e} комментариев`,T.hidden=s};T.addEventListener("click",X);const j=e=>{S=e,T.click()},Z=()=>{C.innerHTML="",S=[]},J=document.body,_=document.querySelector(".big-picture"),Q=_.querySelector(".cancel"),W=({url:e,description:t,likes:o})=>{_.querySelector(".big-picture__img").querySelector("img").src=e,_.querySelector(".social__caption").textContent=t,_.querySelector(".likes-count").textContent=o},Y=e=>{H(e)&&(e.preventDefault(),I())},P=(e=!0)=>{_.classList.toggle("hidden",!e),J.classList.toggle("modal-open",e)};function I(){P(!1),Z()}Q.addEventListener("click",()=>I());const ee=e=>{P(!0),document.addEventListener("keydown",Y),W(e),j(e.comments)},te=25,ne=6,oe=15,re=200,se=20,ce=["Всё отлично!","В целом всё неплохо. Но не всё.","Когда вы делаете фотографию, хорошо бы убирать палец из кадра. В конце концов это просто непрофессионально.","Моя бабушка случайно чихнула с фотоаппаратом в руках и у неё получилась фотография лучше.","Я поскользнулся на банановой кожуре и уронил фотоаппарат на кота и у меня получилась фотография лучше.","Лица у людей на фотке перекошены, как будто их избивают. Как можно было поймать такой неудачный момент?!"],ae=["Пляж","Указатель показывает, направление до пляжа","Скалистый берег","Девушка на пляже с фотоаппаратом","Забавный мисо суп с человечками из риса","Японский автомобиль с открытой ламба дверью","На деревянной тарелке клубника разрезанная на две половики","Две прозрачные чашки с горячим напитком из красной смородины"],le=["Мария","Алексей","Артур","Виктор","Александр","Мариса","Мирон","Анна"],ie=V(),de=()=>Array.from({length:y(1,2)},()=>b(ce)).join(" "),ue=()=>({id:ie(),avatar:`img/avatar-${y(1,ne)}.svg`,message:de(),name:b(le)}),me=e=>({id:e,url:`photos/${e}.jpg`,description:b(ae),likes:y(oe,re),comments:Array.from({length:y(4,se)},ue)}),O=()=>Array.from({length:te},(e,t)=>me(t+1));O();const k=O(),pe=e=>k.find(t=>t.id===e),fe=N("picture"),ge=document.querySelector(".pictures"),_e=e=>{e.preventDefault();const o=+e.currentTarget.dataset.thumbnailId,s=pe(o);ee(s)},ye=({comments:e,description:t,likes:o,url:s,id:n})=>{const r=fe.cloneNode(!0),u=r.querySelector(".picture__img");return u.src=s,u.alt=t,r.querySelector(".picture__comments").textContent=e.length,r.querySelector(".picture__likes").textContent=o,r.dataset.thumbnailId=n,r},Se=e=>{const t=ye(e);return t.addEventListener("click",_e),t},he=e=>U(ge,e,Se);he(k);const l=document.querySelector(".img-upload__form"),Ee=l.querySelector(".scale__control--smaller"),ve=l.querySelector(".scale__control--bigger"),v=l.querySelector(".scale__control--value"),m=l.querySelector(".img-upload__preview"),x=25,A=25,M=100,h=100;let c=100;const Le=()=>{m.style.transform=`scale(${h/100})`,v.value=`${h}%`};m.style.transform=`scale(${h/100})`;v.value=`${h}%`;Ee.addEventListener("click",e=>{e.preventDefault(),c-=x,c<A&&(c=A),v.value=`${c}%`,m.style.transform=`scale(${c/100})`});ve.addEventListener("click",e=>{e.preventDefault(),c+=x,c>M&&(c=M),v.value=`${c}%`,m.style.transform=`scale(${c/100})`});const p=[{range:{min:0,max:1},start:1,step:.1,connect:"lower"},{range:{min:0,max:1},start:1,step:.1,connect:"lower"},{range:{min:0,max:100},start:100,step:1,connect:"lower"},{range:{min:0,max:3},start:3,step:.1,connect:"lower"},{range:{min:1,max:3},start:3,step:.1,connect:"lower"}],a=l.querySelector(".effect-level__slider"),Ce=l.querySelector(".effect-level__value"),be=l.querySelector(".effects__list"),q=l.querySelector(".img-upload__effect-level");let i=" ";function Te(){noUiSlider.create(a,{range:{min:0,max:100},start:100,step:1,connect:"lower",format:{to:function(e){return Number.isInteger(e)?e.toFixed(0):e.toFixed(1)},from:function(e){return parseFloat(e)}}})}let E="";function f(){a.noUiSlider.on("update",()=>{const e=a.noUiSlider.get();Ce.value=e,m.style.filter=`${i}(${e}${E})`})}const g=()=>{q.classList.remove("hidden")},$=()=>{q.classList.add("hidden"),m.style.filter="none"},qe=()=>{switch(q.classList.remove(".hidden"),i){case"none":$();break;case"chrome":a.noUiSlider.updateOptions(p[0]),g(),i="grayscale",f();break;case"sepia":a.noUiSlider.updateOptions(p[1]),g(),f();break;case"marvin":a.noUiSlider.updateOptions(p[2]),g(),i="invert",E="%",f();break;case"phobos":a.noUiSlider.updateOptions(p[3]),g(),i="blur",E="px",f();break;case"heat":a.noUiSlider.updateOptions(p[4]),g(),i="brightness",f();break}};Te();be.addEventListener("change",e=>{e.target.classList.contains("effects__radio")&&(i=e.target.value,E="",qe())});const d=document.querySelector(".img-upload__form"),we=d.querySelector("#upload-file"),L=d.querySelector(".img-upload__overlay"),Ae=L.querySelector("#upload-cancel"),R=d.querySelector(".text__hashtags"),D=d.querySelector(".text__description"),Me=/^#[a-zа-яё0-9]{1,19}$/i,Ue=5,Ne="Неправильный формат хэштэга, должен начинаться с #",Pe="Допустимое количество знаков не больше 140!",w=new Pristine(d,{classTo:"img-upload__field-wrapper",errorTextParent:"img-upload__field-wrapper",errorTextClass:"img-upload__field-wrapper--error"}),Ie=()=>{document.removeEventListener("keydown",F)},Oe=()=>{Ae.addEventListener("click",()=>{L.classList.add("hidden"),document.body.classList.remove("modal-open")}),document.addEventListener("keydown",F),d.reset(),Le(),$()};we.addEventListener("change",e=>{e.preventDefault(),document.body.classList.add("modal-open"),L.classList.remove("hidden"),Oe()});function F(e){e.key==="Escape"&&(document.body.classList.remove("modal-open"),L.classList.add("hidden"),Ie())}R.addEventListener("keydown",e=>{e.key==="Escape"&&e.stopPropagation()});D.addEventListener("keydown",e=>{e.key==="Escape"&&e.stopPropagation()});const ke=e=>e.length<=140,xe=e=>Me.test(e),$e=e=>e.length<=Ue,Re=e=>{const t=e.map(o=>o.toLowerCase());return t.length===new Set(t).size},De=e=>{const t=e.trim().split(" ").filter(o=>o.trim().length);return t.every(xe)&&$e(t)&&Re(t)};w.addValidator(D,ke,Pe);w.addValidator(R,De,Ne);d.addEventListener("submit",e=>{e.preventDefault(),w.validate()});
